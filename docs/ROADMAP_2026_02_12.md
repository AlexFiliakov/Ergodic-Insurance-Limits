# Parallel Implementation Roadmap — Sprint 11 High-Priority Issues

**Date:** 2026-02-12
**Method:** Mikado Method with file-conflict-aware batching for up to 6 parallel Claude Opus 4.6 sessions
**Total Issues:** 42 high-priority issues across 4 categories
**Total Batches:** 8 sequential batches

## Bottleneck Analysis

The primary serialization bottleneck is `manufacturer_balance_sheet.py`, touched by **7 issues** (1337, 1326, 1316, 1308, 1304, 1302, 1297). These must be strictly serialized — one per batch. The secondary bottleneck is `manufacturer.py` (5 issues) and `config/core.py` (3 issues).

### File Conflict Graph — Clusters

| Cluster | Issues | Bottleneck File(s) |
|---------|--------|--------------------|
| Manufacturer (11 issues) | 1337, 1326, 1321, 1316, 1314, 1311, 1308, 1304, 1302, 1297, 1331 | `manufacturer_balance_sheet.py` (7 touches) |
| Simulation/Config (14 issues) | 1353, 1354, 1320, 1307, 1301, 1312, 1324, 1300, 1298, 1296, 1315, 1305, 1299, 1295 | `monte_carlo.py`, `simulation.py`, `decision_engine.py` |
| Summary Statistics (3 issues) | 1355, 1339, 1309 | `summary_statistics.py` |
| Optimization (2 issues) | 1318, 1313 | `optimization.py` |
| Sensitivity/Progress (2 issues) | 1334, 1310 | `sensitivity.py` |
| Standalone (10 issues) | 1358, 1351, 1349, 1347, 1343, 1328, 1322, 1317, 1306, 1303 | None (fully independent) |

### Priority Order

1. **Financial accuracy** (correctness of simulation results)
2. **Mathematical correctness** (statistical/numerical methods)
3. **Performance** (simulation speed)
4. **API usability** (developer experience)

---

## ~~Batch 1: Foundation — Isolated financial correctness fixes and critical math fixes~~

| Issue | Change Title | Files Affected |
|-------|-------------|----------------|
| #1321 | fix: DTL depreciation uses gross PPE pool ignoring asset timing | `manufacturer.py` |
| #1314 | fix: net_income assertion fails with DTA/DTL adjustments | `manufacturer_income.py` |
| #1311 | fix: check_solvency/check_liquidity use inconsistent equity definitions | `manufacturer_metrics.py`, `manufacturer_solvency.py` |
| #1304 | fix: dividends paid from negative net income violating ASC 505-20-45 | `manufacturer_balance_sheet.py` |
| #1343 | fix: raftery_lewis burn-in formula takes log of non-positive value | `convergence_advanced.py` |
| #1328 | fix: MeanRevertingProcess Euler discretization error for large theta*dt | `stochastic_processes.py` |

**Why parallel:** All 6 issues touch completely disjoint files. The 4 financial issues target different manufacturer submodules (manufacturer.py, manufacturer_income.py, manufacturer_metrics.py/solvency.py, manufacturer_balance_sheet.py), and the 2 math issues are standalone modules.

**Why this order:** These are the foundational fixes. Issues #1331 and #1326 in Batch 2 depend on #1314/#1311 and #1321/#1304 respectively being merged first, since they modify the same manufacturer submodules.

### Worktree Setup

```bash
git worktree add C:/worktrees/fix-1321-dtl-depreciation develop -b fix/1321-dtl-depreciation
git worktree add C:/worktrees/fix-1314-net-income-assertion develop -b fix/1314-net-income-assertion
git worktree add C:/worktrees/fix-1311-equity-definitions develop -b fix/1311-equity-definitions
git worktree add C:/worktrees/fix-1304-negative-dividends develop -b fix/1304-negative-dividends
git worktree add C:/worktrees/fix-1343-raftery-lewis-log develop -b fix/1343-raftery-lewis-log
git worktree add C:/worktrees/fix-1328-ou-discretization develop -b fix/1328-ou-discretization
```

### Session Launch

```bash
cd "C:/worktrees/fix-1321-dtl-depreciation";claude --dangerously-skip-permissions
cd "C:/worktrees/fix-1314-net-income-assertion";claude --dangerously-skip-permissions
cd "C:/worktrees/fix-1311-equity-definitions";claude --dangerously-skip-permissions
cd "C:/worktrees/fix-1304-negative-dividends";claude --dangerously-skip-permissions
cd "C:/worktrees/fix-1343-raftery-lewis-log";claude --dangerously-skip-permissions
cd "C:/worktrees/fix-1328-ou-discretization";claude --dangerously-skip-permissions
```

### Prompts

**#1321:**
```
Make sure your branch is up to date with `develop` before starting work. Use subagents to parallelize the work whenever possible and resolve issue #1321. Ensure all relevant tests pass, but skip full-suite validation because it times out. Work in the current branch, which is part of a git worktree. Plan, execute, review. Commit and create a pull request to the `develop` branch, but don't push the pr until I review.
```

**#1314:**
```
Make sure your branch is up to date with `develop` before starting work. Use subagents to parallelize the work whenever possible and resolve issue #1314. Ensure all relevant tests pass, but skip full-suite validation because it times out. Work in the current branch, which is part of a git worktree. Plan, execute, review. Commit and create a pull request to the `develop` branch, but don't push the pr until I review.
```

**#1311:**
```
Make sure your branch is up to date with `develop` before starting work. Use subagents to parallelize the work whenever possible and resolve issue #1311. Ensure all relevant tests pass, but skip full-suite validation because it times out. Work in the current branch, which is part of a git worktree. Plan, execute, review. Commit and create a pull request to the `develop` branch, but don't push the pr until I review.
```

**#1304:**
```
Make sure your branch is up to date with `develop` before starting work. Use subagents to parallelize the work whenever possible and resolve issue #1304. Ensure all relevant tests pass, but skip full-suite validation because it times out. Work in the current branch, which is part of a git worktree. Plan, execute, review. Commit and create a pull request to the `develop` branch, but don't push the pr until I review.
```

**#1343:**
```
Make sure your branch is up to date with `develop` before starting work. Use subagents to parallelize the work whenever possible and resolve issue #1343. Ensure all relevant tests pass, but skip full-suite validation because it times out. Work in the current branch, which is part of a git worktree. Plan, execute, review. Commit and create a pull request to the `develop` branch, but don't push the pr until I review.
```

**#1328:**
```
Make sure your branch is up to date with `develop` before starting work. Use subagents to parallelize the work whenever possible and resolve issue #1328. Ensure all relevant tests pass, but skip full-suite validation because it times out. Work in the current branch, which is part of a git worktree. Plan, execute, review. Commit and create a pull request to the `develop` branch, but don't push the pr until I review.
```

---

## ~~Batch 2: Financial cascade from Batch 1 + performance hotspots~~

| Issue | Change Title | Files Affected |
|-------|-------------|----------------|
| #1331 | fix: tax_handler.calculate_tax_liability mutates NOL state as side-effect | `tax_handler.py`, `manufacturer_income.py`, `manufacturer_metrics.py` |
| #1326 | fix: COGS and operating expenses never recorded as ledger entries | `manufacturer.py`, `manufacturer_balance_sheet.py`, `ledger.py` |
| #1322 | fix: convergence.calculate_ess truncates at first negative ACF, not Geyer's IPS | `convergence.py` |
| #1358 | perf: ruin_probability uses deepcopy instead of create_fresh | `ruin_probability.py` |
| #1351 | perf: statistical_tests 5 bootstrap for-loops should use vectorized resampling | `statistical_tests.py` |
| #1349 | perf: gpu_objective DE mutation/crossover uses Python for-loops | `gpu_objective.py` |

**Why parallel:** #1331 touches `tax_handler.py` + `manufacturer_income.py` + `manufacturer_metrics.py` (none of which overlap with #1326's `manufacturer.py` + `manufacturer_balance_sheet.py` + `ledger.py`). The remaining 4 issues are fully standalone modules.

**Why this order:** #1331 depends on Batch 1's #1314 (manufacturer_income.py) and #1311 (manufacturer_metrics.py) being merged. #1326 depends on #1321 (manufacturer.py) and #1304 (manufacturer_balance_sheet.py). The performance issues (#1358, #1351, #1349) are standalone and fill remaining parallel slots.

**Merge before starting:** All 6 PRs from Batch 1 must be merged into `develop` first.

### Worktree Setup

```bash
git worktree add C:/worktrees/fix-1331-tax-nol-mutation develop -b fix/1331-tax-nol-mutation
git worktree add C:/worktrees/fix-1326-cogs-opex-ledger develop -b fix/1326-cogs-opex-ledger
git worktree add C:/worktrees/fix-1322-ess-geyer-ips develop -b fix/1322-ess-geyer-ips
git worktree add C:/worktrees/perf-1358-ruin-create-fresh develop -b perf/1358-ruin-create-fresh
git worktree add C:/worktrees/perf-1351-vectorize-bootstrap develop -b perf/1351-vectorize-bootstrap
git worktree add C:/worktrees/perf-1349-gpu-de-vectorize develop -b perf/1349-gpu-de-vectorize
```

### Session Launch

```bash
cd "C:/worktrees/fix-1331-tax-nol-mutation";claude --dangerously-skip-permissions
cd "C:/worktrees/fix-1326-cogs-opex-ledger";claude --dangerously-skip-permissions
cd "C:/worktrees/fix-1322-ess-geyer-ips";claude --dangerously-skip-permissions
cd "C:/worktrees/perf-1358-ruin-create-fresh";claude --dangerously-skip-permissions
cd "C:/worktrees/perf-1351-vectorize-bootstrap";claude --dangerously-skip-permissions
cd "C:/worktrees/perf-1349-gpu-de-vectorize";claude --dangerously-skip-permissions
```

### Prompts

**#1331:**
```
Make sure your branch is up to date with `develop` before starting work. Use subagents to parallelize the work whenever possible and resolve issue #1331. Ensure all relevant tests pass, but skip full-suite validation because it times out. Work in the current branch, which is part of a git worktree. Plan, execute, review. Commit and create a pull request to the `develop` branch, but don't push the pr until I review.
```

**#1326:**
```
Make sure your branch is up to date with `develop` before starting work. Use subagents to parallelize the work whenever possible and resolve issue #1326. Ensure all relevant tests pass, but skip full-suite validation because it times out. Work in the current branch, which is part of a git worktree. Plan, execute, review. Commit and create a pull request to the `develop` branch, but don't push the pr until I review.
```

**#1322:**
```
Make sure your branch is up to date with `develop` before starting work. Use subagents to parallelize the work whenever possible and resolve issue #1322. Ensure all relevant tests pass, but skip full-suite validation because it times out. Work in the current branch, which is part of a git worktree. Plan, execute, review. Commit and create a pull request to the `develop` branch, but don't push the pr until I review.
```

**#1358:**
```
Make sure your branch is up to date with `develop` before starting work. Use subagents to parallelize the work whenever possible and resolve issue #1358. Ensure all relevant tests pass, but skip full-suite validation because it times out. Work in the current branch, which is part of a git worktree. Plan, execute, review. Commit and create a pull request to the `develop` branch, but don't push the pr until I review.
```

**#1351:**
```
Make sure your branch is up to date with `develop` before starting work. Use subagents to parallelize the work whenever possible and resolve issue #1351. Ensure all relevant tests pass, but skip full-suite validation because it times out. Work in the current branch, which is part of a git worktree. Plan, execute, review. Commit and create a pull request to the `develop` branch, but don't push the pr until I review.
```

**#1349:**
```
Make sure your branch is up to date with `develop` before starting work. Use subagents to parallelize the work whenever possible and resolve issue #1349. Ensure all relevant tests pass, but skip full-suite validation because it times out. Work in the current branch, which is part of a git worktree. Plan, execute, review. Commit and create a pull request to the `develop` branch, but don't push the pr until I review.
```

### Team Recommendation

**#1326** benefits from a Claude team approach. This issue touches 3 files (manufacturer.py, manufacturer_balance_sheet.py, ledger.py) and requires understanding the full accounting cycle to add COGS and operating expense ledger entries consistently.

**Team prompt for #1326:**
```
Make sure your branch is up to date with `develop` before starting work. Resolve issue #1326 using a team of agents. Spawn a team with three agents:
1. "ledger-agent": Research the Ledger class in ledger.py to understand existing entry types, then add new AccountType entries for COGS and operating expenses.
2. "manufacturer-agent": Research manufacturer.py step() method to understand where COGS and operating expenses are calculated, then add ledger entry recording calls at the correct points.
3. "balance-sheet-agent": Research manufacturer_balance_sheet.py to ensure the new ledger entries are properly reflected in balance sheet generation.
Coordinate the agents so the ledger-agent finishes first (defines the new entry types), then the other two proceed in parallel. Ensure all relevant tests pass, but skip full-suite validation because it times out. Work in the current branch, which is part of a git worktree. Commit and create a pull request to the `develop` branch, but don't push the pr until I review.
```

---

## ~~Batch 3: Mathematical correctness sweep + next financial fix + final performance issue~~

| Issue | Change Title | Files Affected |
|-------|-------------|----------------|
| #1302 | fix: step() revenue double-counts cash impact via working capital adjustment | `manufacturer.py`, `manufacturer_balance_sheet.py` |
| #1355 | fix: summary_statistics stderr uses population std and total n instead of sample std and ESS | `summary_statistics.py` |
| #1318 | fix: PenaltyMethodOptimizer uses quadratic penalty instead of exact penalty | `optimization.py` |
| #1353 | fix: monte_carlo._check_convergence splits single chain into pseudo-chains | `monte_carlo.py` |
| #1334 | fix: sensitivity elasticity uses unsigned range instead of point elasticity | `sensitivity.py` |
| #1347 | perf: gpu_mc_engine._scatter_events Python for-loop over n_sims | `gpu_mc_engine.py` |

**Why parallel:** All 6 issues touch completely disjoint files. #1302 is the only manufacturer cluster issue (serialized on manufacturer_balance_sheet.py). The other 5 are cluster starters or standalone modules.

**Why this order:** #1302 fixes revenue cash double-counting (depends on #1326 being merged for correct ledger entries). #1355, #1318, #1353, #1334 start their respective clusters so downstream issues can follow. #1347 fills the last slot.

**Merge before starting:** All 6 PRs from Batch 2 must be merged into `develop` first.

### Worktree Setup

```bash
git worktree add C:/worktrees/fix-1302-revenue-cash-double-count develop -b fix/1302-revenue-cash-double-count
git worktree add C:/worktrees/fix-1355-stderr-ess develop -b fix/1355-stderr-ess
git worktree add C:/worktrees/fix-1318-exact-penalty develop -b fix/1318-exact-penalty
git worktree add C:/worktrees/fix-1353-convergence-pseudo-chains develop -b fix/1353-convergence-pseudo-chains
git worktree add C:/worktrees/fix-1334-point-elasticity develop -b fix/1334-point-elasticity
git worktree add C:/worktrees/perf-1347-gpu-scatter-vectorize develop -b perf/1347-gpu-scatter-vectorize
```

### Session Launch

```bash
cd "C:/worktrees/fix-1302-revenue-cash-double-count";claude --dangerously-skip-permissions --continue
cd "C:/worktrees/fix-1355-stderr-ess";claude --dangerously-skip-permissions --continue
cd "C:/worktrees/fix-1318-exact-penalty";claude --dangerously-skip-permissions --continue
cd "C:/worktrees/fix-1353-convergence-pseudo-chains";claude --dangerously-skip-permissions --continue
cd "C:/worktrees/fix-1334-point-elasticity";claude --dangerously-skip-permissions --continue
cd "C:/worktrees/perf-1347-gpu-scatter-vectorize";claude --dangerously-skip-permissions --continue
```

### Prompts

**#1302:**
```
Make sure your branch is up to date with `develop` before starting work. Use subagents to parallelize the work whenever possible and resolve issue #1302. Ensure all relevant tests pass, but skip full-suite validation because it times out. Work in the current branch, which is part of a git worktree. Plan, execute, review. Commit and create a pull request to the `develop` branch, but don't push the pr until I review.
```

**#1355:**
```
Make sure your branch is up to date with `develop` before starting work. Use subagents to parallelize the work whenever possible and resolve issue #1355. Ensure all relevant tests pass, but skip full-suite validation because it times out. Work in the current branch, which is part of a git worktree. Plan, execute, review. Commit and create a pull request to the `develop` branch, but don't push the pr until I review.
```

**#1318:**
```
Make sure your branch is up to date with `develop` before starting work. Use subagents to parallelize the work whenever possible and resolve issue #1318. Ensure all relevant tests pass, but skip full-suite validation because it times out. Work in the current branch, which is part of a git worktree. Plan, execute, review. Commit and create a pull request to the `develop` branch, but don't push the pr until I review.
```

**#1353:**
```
Make sure your branch is up to date with `develop` before starting work. Use subagents to parallelize the work whenever possible and resolve issue #1353. Ensure all relevant tests pass, but skip full-suite validation because it times out. Work in the current branch, which is part of a git worktree. Plan, execute, review. Commit and create a pull request to the `develop` branch, but don't push the pr until I review.
```

**#1334:**
```
Make sure your branch is up to date with `develop` before starting work. Use subagents to parallelize the work whenever possible and resolve issue #1334. Ensure all relevant tests pass, but skip full-suite validation because it times out. Work in the current branch, which is part of a git worktree. Plan, execute, review. Commit and create a pull request to the `develop` branch, but don't push the pr until I review.
```

**#1347:**
```
Make sure your branch is up to date with `develop` before starting work. Use subagents to parallelize the work whenever possible and resolve issue #1347. Ensure all relevant tests pass, but skip full-suite validation because it times out. Work in the current branch, which is part of a git worktree. Plan, execute, review. Commit and create a pull request to the `develop` branch, but don't push the pr until I review.
```

---

## Batch 4: Cluster continuations + standalone math + API usability starts

| Issue | Change Title | Files Affected |
|-------|-------------|----------------|
| #1308 | fix: step() computes working capital before recording revenue | `manufacturer.py`, `manufacturer_balance_sheet.py` |
| #1339 | fix: AIC does not account for sample size (no AICc correction) | `summary_statistics.py` |
| #1313 | fix: AugmentedLagrangianOptimizer inequality multiplier update sign | `optimization.py` |
| #1306 | fix: get_knee_points uses distance-to-ideal, not geometric knee | `pareto_frontier.py` |
| #1324 | fix: DecisionMetrics has 20+ flat fields with no logical grouping | `decision_engine.py` |
| #1320 | fix: Simulation.__init__ creates default loss generator with hardcoded M severity | `simulation.py` |

**Why parallel:** All 6 touch disjoint files. #1308 continues the manufacturer serialization on manufacturer_balance_sheet.py. #1339 and #1313 continue their respective cluster chains. #1306 is standalone. #1324 and #1320 start their simulation cluster paths.

**Why this order:** #1308 depends on #1302 (revenue accounting fix). #1339 depends on #1355 (summary_statistics.py). #1313 depends on #1318 (optimization.py). #1324 and #1320 open paths for later issues #1300/#1298 and #1307 respectively.

**Merge before starting:** All 6 PRs from Batch 3 must be merged into `develop` first.

### Worktree Setup

```bash
git worktree add C:/worktrees/fix-1308-working-capital-timing develop -b fix/1308-working-capital-timing
git worktree add C:/worktrees/fix-1339-aicc-correction develop -b fix/1339-aicc-correction
git worktree add C:/worktrees/fix-1313-alm-multiplier-sign develop -b fix/1313-alm-multiplier-sign
git worktree add C:/worktrees/fix-1306-knee-point-curvature develop -b fix/1306-knee-point-curvature
git worktree add C:/worktrees/fix-1324-decision-metrics-grouping develop -b fix/1324-decision-metrics-grouping
git worktree add C:/worktrees/fix-1320-default-loss-generator develop -b fix/1320-default-loss-generator
```

### Session Launch

```bash
cd "C:/worktrees/fix-1308-working-capital-timing";claude --dangerously-skip-permissions
cd "C:/worktrees/fix-1339-aicc-correction";claude --dangerously-skip-permissions
cd "C:/worktrees/fix-1313-alm-multiplier-sign";claude --dangerously-skip-permissions
cd "C:/worktrees/fix-1306-knee-point-curvature";claude --dangerously-skip-permissions
cd "C:/worktrees/fix-1324-decision-metrics-grouping";claude --dangerously-skip-permissions
cd "C:/worktrees/fix-1320-default-loss-generator";claude --dangerously-skip-permissions
```

### Prompts

**#1308:**
```
Make sure your branch is up to date with `develop` before starting work. Use subagents to parallelize the work whenever possible and resolve issue #1308. Ensure all relevant tests pass, but skip full-suite validation because it times out. Work in the current branch, which is part of a git worktree. Plan, execute, review. Commit and create a pull request to the `develop` branch, but don't push the pr until I review.
```

**#1339:**
```
Make sure your branch is up to date with `develop` before starting work. Use subagents to parallelize the work whenever possible and resolve issue #1339. Ensure all relevant tests pass, but skip full-suite validation because it times out. Work in the current branch, which is part of a git worktree. Plan, execute, review. Commit and create a pull request to the `develop` branch, but don't push the pr until I review.
```

**#1313:**
```
Make sure your branch is up to date with `develop` before starting work. Use subagents to parallelize the work whenever possible and resolve issue #1313. Ensure all relevant tests pass, but skip full-suite validation because it times out. Work in the current branch, which is part of a git worktree. Plan, execute, review. Commit and create a pull request to the `develop` branch, but don't push the pr until I review.
```

**#1306:**
```
Make sure your branch is up to date with `develop` before starting work. Use subagents to parallelize the work whenever possible and resolve issue #1306. Ensure all relevant tests pass, but skip full-suite validation because it times out. Work in the current branch, which is part of a git worktree. Plan, execute, review. Commit and create a pull request to the `develop` branch, but don't push the pr until I review.
```

**#1324:**
```
Make sure your branch is up to date with `develop` before starting work. Use subagents to parallelize the work whenever possible and resolve issue #1324. Ensure all relevant tests pass, but skip full-suite validation because it times out. Work in the current branch, which is part of a git worktree. Plan, execute, review. Commit and create a pull request to the `develop` branch, but don't push the pr until I review.
```

**#1320:**
```
Make sure your branch is up to date with `develop` before starting work. Use subagents to parallelize the work whenever possible and resolve issue #1320. Ensure all relevant tests pass, but skip full-suite validation because it times out. Work in the current branch, which is part of a git worktree. Plan, execute, review. Commit and create a pull request to the `develop` branch, but don't push the pr until I review.
```

---

## Batch 5: Financial + math cluster completions + API expansion

| Issue | Change Title | Files Affected |
|-------|-------------|----------------|
| #1316 | fix: going concern current_ratio excludes insurance_receivables | `manufacturer_balance_sheet.py`, `manufacturer_solvency.py` |
| #1309 | fix: weighted_percentile uses searchsorted with off-by-one boundary | `summary_statistics.py` |
| #1312 | fix: ErgodicAnalyzer.compare_scenarios() rejects MonteCarloResults | `ergodic_analyzer.py`, `monte_carlo.py` |
| #1300 | fix: decision_engine._run_simulation ignores depreciation/WC/collateral | `decision_engine.py` |
| #1305 | fix: AnalysisResults.summary() uses deprecated dict-style access | `_run_analysis.py` |
| #1354 | perf: insurance_program.ProgramState history grows unboundedly | `insurance_program.py` |

**Why parallel:** All 6 touch disjoint files. #1316 continues the manufacturer_balance_sheet.py serialization. #1309 finishes the summary_statistics cluster. #1312 and #1300/#1305 continue sim cluster paths on different files.

**Why this order:** #1316 depends on #1308 (manufacturer_balance_sheet.py). #1309 depends on #1339 (summary_statistics.py). #1312 depends on #1353 (monte_carlo.py). #1300 depends on #1324 (decision_engine.py). #1305 and #1354 are now unblocked.

**Merge before starting:** All 6 PRs from Batch 4 must be merged into `develop` first.

### Worktree Setup

```bash
git worktree add C:/worktrees/fix-1316-current-ratio-receivables develop -b fix/1316-current-ratio-receivables
git worktree add C:/worktrees/fix-1309-weighted-percentile develop -b fix/1309-weighted-percentile
git worktree add C:/worktrees/fix-1312-compare-scenarios-mc develop -b fix/1312-compare-scenarios-mc
git worktree add C:/worktrees/fix-1300-decision-engine-model develop -b fix/1300-decision-engine-model
git worktree add C:/worktrees/fix-1305-analysis-results-access develop -b fix/1305-analysis-results-access
git worktree add C:/worktrees/perf-1354-programstate-history develop -b perf/1354-programstate-history
```

### Session Launch

```bash
cd "C:/worktrees/fix-1316-current-ratio-receivables";claude --dangerously-skip-permissions
cd "C:/worktrees/fix-1309-weighted-percentile";claude --dangerously-skip-permissions
cd "C:/worktrees/fix-1312-compare-scenarios-mc";claude --dangerously-skip-permissions
cd "C:/worktrees/fix-1300-decision-engine-model";claude --dangerously-skip-permissions
cd "C:/worktrees/fix-1305-analysis-results-access";claude --dangerously-skip-permissions
cd "C:/worktrees/perf-1354-programstate-history";claude --dangerously-skip-permissions
```

### Prompts

**#1316:**
```
Make sure your branch is up to date with `develop` before starting work. Use subagents to parallelize the work whenever possible and resolve issue #1316. Ensure all relevant tests pass, but skip full-suite validation because it times out. Work in the current branch, which is part of a git worktree. Plan, execute, review. Commit and create a pull request to the `develop` branch, but don't push the pr until I review.
```

**#1309:**
```
Make sure your branch is up to date with `develop` before starting work. Use subagents to parallelize the work whenever possible and resolve issue #1309. Ensure all relevant tests pass, but skip full-suite validation because it times out. Work in the current branch, which is part of a git worktree. Plan, execute, review. Commit and create a pull request to the `develop` branch, but don't push the pr until I review.
```

**#1312:**
```
Make sure your branch is up to date with `develop` before starting work. Use subagents to parallelize the work whenever possible and resolve issue #1312. Ensure all relevant tests pass, but skip full-suite validation because it times out. Work in the current branch, which is part of a git worktree. Plan, execute, review. Commit and create a pull request to the `develop` branch, but don't push the pr until I review.
```

**#1300:**
```
Make sure your branch is up to date with `develop` before starting work. Use subagents to parallelize the work whenever possible and resolve issue #1300. Ensure all relevant tests pass, but skip full-suite validation because it times out. Work in the current branch, which is part of a git worktree. Plan, execute, review. Commit and create a pull request to the `develop` branch, but don't push the pr until I review.
```

**#1305:**
```
Make sure your branch is up to date with `develop` before starting work. Use subagents to parallelize the work whenever possible and resolve issue #1305. Ensure all relevant tests pass, but skip full-suite validation because it times out. Work in the current branch, which is part of a git worktree. Plan, execute, review. Commit and create a pull request to the `develop` branch, but don't push the pr until I review.
```

**#1354:**
```
Make sure your branch is up to date with `develop` before starting work. Use subagents to parallelize the work whenever possible and resolve issue #1354. Ensure all relevant tests pass, but skip full-suite validation because it times out. Work in the current branch, which is part of a git worktree. Plan, execute, review. Commit and create a pull request to the `develop` branch, but don't push the pr until I review.
```

---

## Batch 6: API usability sweep + financial closing entries

| Issue | Change Title | Files Affected |
|-------|-------------|----------------|
| #1297 | fix: _record_closing_entries only closes SALES_REVENUE and DEPRECIATION | `manufacturer_balance_sheet.py`, `ledger.py` |
| #1307 | fix: SimulationResults lacks __repr__ and key summary attributes | `simulation.py` |
| #1298 | fix: InsuranceDecisionEngine requires 4 complex objects — no simple factory | `decision_engine.py` |
| #1295 | fix: Config.apply_module/apply_preset mutate Pydantic model in-place | `config/core.py` |
| #1317 | fix: visualization module exports 40+ functions with no namespace grouping | `visualization/__init__.py` |
| #1303 | fix: RiskMetrics sign convention undocumented | `risk_metrics.py` |

**Why parallel:** All 6 touch disjoint files. #1297 continues manufacturer_balance_sheet.py serialization. The other 5 are independent API usability fixes across different modules.

**Why this order:** #1297 depends on #1316 (manufacturer_balance_sheet.py). #1307 depends on #1320 (simulation.py, Batch 4). #1298 depends on #1300 (decision_engine.py, Batch 5). #1295 opens the path for #1299 (config/core.py) in Batch 7.

**Merge before starting:** All 6 PRs from Batch 5 must be merged into `develop` first.

### Worktree Setup

```bash
git worktree add C:/worktrees/fix-1297-gaap-closing-entries develop -b fix/1297-gaap-closing-entries
git worktree add C:/worktrees/fix-1307-simulation-results-repr develop -b fix/1307-simulation-results-repr
git worktree add C:/worktrees/fix-1298-decision-engine-factory develop -b fix/1298-decision-engine-factory
git worktree add C:/worktrees/fix-1295-config-immutability develop -b fix/1295-config-immutability
git worktree add C:/worktrees/fix-1317-viz-namespace develop -b fix/1317-viz-namespace
git worktree add C:/worktrees/fix-1303-risk-metrics-sign develop -b fix/1303-risk-metrics-sign
```

### Session Launch

```bash
cd "C:/worktrees/fix-1297-gaap-closing-entries";claude --dangerously-skip-permissions
cd "C:/worktrees/fix-1307-simulation-results-repr";claude --dangerously-skip-permissions
cd "C:/worktrees/fix-1298-decision-engine-factory";claude --dangerously-skip-permissions
cd "C:/worktrees/fix-1295-config-immutability";claude --dangerously-skip-permissions
cd "C:/worktrees/fix-1317-viz-namespace";claude --dangerously-skip-permissions
cd "C:/worktrees/fix-1303-risk-metrics-sign";claude --dangerously-skip-permissions
```

### Prompts

**#1297:**
```
Make sure your branch is up to date with `develop` before starting work. Use subagents to parallelize the work whenever possible and resolve issue #1297. Ensure all relevant tests pass, but skip full-suite validation because it times out. Work in the current branch, which is part of a git worktree. Plan, execute, review. Commit and create a pull request to the `develop` branch, but don't push the pr until I review.
```

**#1307:**
```
Make sure your branch is up to date with `develop` before starting work. Use subagents to parallelize the work whenever possible and resolve issue #1307. Ensure all relevant tests pass, but skip full-suite validation because it times out. Work in the current branch, which is part of a git worktree. Plan, execute, review. Commit and create a pull request to the `develop` branch, but don't push the pr until I review.
```

**#1298:**
```
Make sure your branch is up to date with `develop` before starting work. Use subagents to parallelize the work whenever possible and resolve issue #1298. Ensure all relevant tests pass, but skip full-suite validation because it times out. Work in the current branch, which is part of a git worktree. Plan, execute, review. Commit and create a pull request to the `develop` branch, but don't push the pr until I review.
```

**#1295:**
```
Make sure your branch is up to date with `develop` before starting work. Use subagents to parallelize the work whenever possible and resolve issue #1295. Ensure all relevant tests pass, but skip full-suite validation because it times out. Work in the current branch, which is part of a git worktree. Plan, execute, review. Commit and create a pull request to the `develop` branch, but don't push the pr until I review.
```

**#1317:**
```
Make sure your branch is up to date with `develop` before starting work. Use subagents to parallelize the work whenever possible and resolve issue #1317. Ensure all relevant tests pass, but skip full-suite validation because it times out. Work in the current branch, which is part of a git worktree. Plan, execute, review. Commit and create a pull request to the `develop` branch, but don't push the pr until I review.
```

**#1303:**
```
Make sure your branch is up to date with `develop` before starting work. Use subagents to parallelize the work whenever possible and resolve issue #1303. Ensure all relevant tests pass, but skip full-suite validation because it times out. Work in the current branch, which is part of a git worktree. Plan, execute, review. Commit and create a pull request to the `develop` branch, but don't push the pr until I review.
```

---

## Batch 7: Cross-cutting refactors + final financial fix

| Issue | Change Title | Files Affected |
|-------|-------------|----------------|
| #1337 | fix: insolvency detection uses equity-based check but step() allows cash-negative states | `manufacturer.py`, `manufacturer_balance_sheet.py`, `manufacturer_solvency.py` |
| #1296 | fix: run_analysis() coverage_limit conflicts with InsuranceProgram.simple() limit | `_run_analysis.py`, `decision_engine.py`, `insurance_program.py` |
| #1310 | fix: progress_monitor.py uses print() for all output | `progress_monitor.py`, `batch_processor.py`, `bootstrap_analysis.py`, `sensitivity.py`, `trajectory_storage.py` |
| #1299 | fix: Config.validate_completeness() silently returns issues list | `config/core.py`, `config_manager.py` |

**Why parallel:** All 4 touch disjoint file sets. #1337 is the final manufacturer cluster issue. #1296, #1310, and #1299 touch entirely different modules.

**Why this order:** #1337 is the capstone financial fix — it depends on correct equity calculations from all prior manufacturer fixes. #1296 depends on #1298 (decision_engine.py) and #1305 (_run_analysis.py). #1310 depends on #1334 (sensitivity.py). #1299 depends on #1295 (config/core.py).

**Merge before starting:** All 6 PRs from Batch 6 must be merged into `develop` first.

### Worktree Setup

```bash
git worktree add C:/worktrees/fix-1337-insolvency-detection develop -b fix/1337-insolvency-detection
git worktree add C:/worktrees/fix-1296-coverage-limit-param develop -b fix/1296-coverage-limit-param
git worktree add C:/worktrees/fix-1310-print-to-logging develop -b fix/1310-print-to-logging
git worktree add C:/worktrees/fix-1299-validate-raises develop -b fix/1299-validate-raises
```

### Session Launch

```bash
cd "C:/worktrees/fix-1337-insolvency-detection";claude --dangerously-skip-permissions
cd "C:/worktrees/fix-1296-coverage-limit-param";claude --dangerously-skip-permissions
cd "C:/worktrees/fix-1310-print-to-logging";claude --dangerously-skip-permissions
cd "C:/worktrees/fix-1299-validate-raises";claude --dangerously-skip-permissions
```

### Prompts

**#1337:**
```
Make sure your branch is up to date with `develop` before starting work. Use subagents to parallelize the work whenever possible and resolve issue #1337. Ensure all relevant tests pass, but skip full-suite validation because it times out. Work in the current branch, which is part of a git worktree. Plan, execute, review. Commit and create a pull request to the `develop` branch, but don't push the pr until I review.
```

**#1296:**
```
Make sure your branch is up to date with `develop` before starting work. Use subagents to parallelize the work whenever possible and resolve issue #1296. Ensure all relevant tests pass, but skip full-suite validation because it times out. Work in the current branch, which is part of a git worktree. Plan, execute, review. Commit and create a pull request to the `develop` branch, but don't push the pr until I review.
```

**#1310:**
```
Make sure your branch is up to date with `develop` before starting work. Use subagents to parallelize the work whenever possible and resolve issue #1310. Ensure all relevant tests pass, but skip full-suite validation because it times out. Work in the current branch, which is part of a git worktree. Plan, execute, review. Commit and create a pull request to the `develop` branch, but don't push the pr until I review.
```

**#1299:**
```
Make sure your branch is up to date with `develop` before starting work. Use subagents to parallelize the work whenever possible and resolve issue #1299. Ensure all relevant tests pass, but skip full-suite validation because it times out. Work in the current branch, which is part of a git worktree. Plan, execute, review. Commit and create a pull request to the `develop` branch, but don't push the pr until I review.
```

### Team Recommendations

**#1337** benefits from a Claude team approach. This is the capstone insolvency detection fix touching 3 files, requiring careful analysis of the step() execution ordering.

**Team prompt for #1337:**
```
Make sure your branch is up to date with `develop` before starting work. Resolve issue #1337 using a team of agents. Spawn a team with three agents:
1. "step-analyzer": Read manufacturer.py, trace the step() method execution order, and document exactly when cash goes negative vs when equity is checked. Identify the window where cash-negative states exist before equity impact.
2. "solvency-fixer": After step-analyzer reports, modify manufacturer_solvency.py to add cash-based insolvency detection alongside equity-based checks.
3. "balance-sheet-fixer": After step-analyzer reports, modify manufacturer_balance_sheet.py to ensure balance sheet reflects the correct solvency state after step() ordering changes.
Ensure all relevant tests pass, but skip full-suite validation because it times out. Work in the current branch, which is part of a git worktree. Commit and create a pull request to the `develop` branch, but don't push the pr until I review.
```

**#1310** benefits from a Claude team approach. This issue converts print() to logging across 5 files requiring consistent API patterns.

**Team prompt for #1310:**
```
Make sure your branch is up to date with `develop` before starting work. Resolve issue #1310 using a team of agents. Spawn a team with five agents, one for each file:
1. "progress-monitor-agent": Convert all print() calls in progress_monitor.py to use Python's logging module. Add a module-level logger. Preserve all existing message content.
2. "batch-processor-agent": Convert all print() calls in batch_processor.py to use Python's logging module.
3. "bootstrap-agent": Convert all print() calls in bootstrap_analysis.py to use Python's logging module.
4. "sensitivity-agent": Convert all print() calls in sensitivity.py to use Python's logging module.
5. "trajectory-agent": Convert all print() calls in trajectory_storage.py to use Python's logging module.
All agents should use the same pattern: `logger = logging.getLogger(__name__)` at module level, then `logger.info()` for status messages and `logger.warning()` for warnings. Ensure all relevant tests pass, but skip full-suite validation because it times out. Work in the current branch, which is part of a git worktree. Commit and create a pull request to the `develop` branch, but don't push the pr until I review.
```

---

## Batch 8: Final integrations — multi-file API refactors

| Issue | Change Title | Files Affected |
|-------|-------------|----------------|
| #1301 | fix: Simulation.compare_insurance_strategies() classmethod should be standalone | `simulation.py`, `_run_analysis.py`, `monte_carlo.py` |
| #1315 | fix: InsuranceProgram has no from_config() factory | `config/core.py`, `config/insurance.py`, `insurance_program.py` |

**Why parallel:** These two issues touch completely disjoint file sets. #1301 modifies simulation/analysis modules while #1315 modifies config/insurance modules.

**Why this order:** These are the final issues. #1301 depends on #1307 (simulation.py), #1305 (_run_analysis.py), and #1312 (monte_carlo.py) all being merged. #1315 depends on #1299 (config/core.py) and #1354 (insurance_program.py) being merged. Both are API refactors best done after all correctness fixes are in place.

**Merge before starting:** All 4 PRs from Batch 7 must be merged into `develop` first.

### Worktree Setup

```bash
git worktree add C:/worktrees/fix-1301-compare-strategies-standalone develop -b fix/1301-compare-strategies-standalone
git worktree add C:/worktrees/fix-1315-insurance-program-factory develop -b fix/1315-insurance-program-factory
```

### Session Launch

```bash
cd "C:/worktrees/fix-1301-compare-strategies-standalone";claude --dangerously-skip-permissions
cd "C:/worktrees/fix-1315-insurance-program-factory";claude --dangerously-skip-permissions
```

### Prompts

**#1301:**
```
Make sure your branch is up to date with `develop` before starting work. Use subagents to parallelize the work whenever possible and resolve issue #1301. Ensure all relevant tests pass, but skip full-suite validation because it times out. Work in the current branch, which is part of a git worktree. Plan, execute, review. Commit and create a pull request to the `develop` branch, but don't push the pr until I review.
```

**#1315:**
```
Make sure your branch is up to date with `develop` before starting work. Use subagents to parallelize the work whenever possible and resolve issue #1315. Ensure all relevant tests pass, but skip full-suite validation because it times out. Work in the current branch, which is part of a git worktree. Plan, execute, review. Commit and create a pull request to the `develop` branch, but don't push the pr until I review.
```

---

## Summary

| Batch | Issues | Parallel Sessions | Focus |
|-------|--------|-------------------|-------|
| 1 | #1321, #1314, #1311, #1304, #1343, #1328 | 6 | Foundation financial + critical math |
| 2 | #1331, #1326, #1322, #1358, #1351, #1349 | 6 | Financial cascade + performance |
| 3 | #1302, #1355, #1318, #1353, #1334, #1347 | 6 | Math correctness sweep + financial |
| 4 | #1308, #1339, #1313, #1306, #1324, #1320 | 6 | Cluster continuations + API starts |
| 5 | #1316, #1309, #1312, #1300, #1305, #1354 | 6 | Cluster completions + API expansion |
| 6 | #1297, #1307, #1298, #1295, #1317, #1303 | 6 | API usability sweep + closing entries |
| 7 | #1337, #1296, #1310, #1299 | 4 | Cross-cutting refactors |
| 8 | #1301, #1315 | 2 | Final multi-file integrations |

**Total:** 42 issues across 8 sequential batches, 42 parallel sessions total.

### Critical Path

The critical path runs through the manufacturer_balance_sheet.py serialization:

```
B1:#1304 → B2:#1326 → B3:#1302 → B4:#1308 → B5:#1316 → B6:#1297 → B7:#1337
```

This 7-step chain determines the minimum number of batches regardless of parallelism.

### Worktree Cleanup

After each batch is merged, remove the worktrees:

```bash
# After Batch N is merged:
git worktree remove C:/worktrees/<branch-name>
# Repeat for each worktree in the batch
```
